!function(t){"use strict";var e={COMMA:",",RETURN:"\r",NEWLINE:"\n",SEMICOLON:";",TAB:"\t"},o={CURRENCY:"CURRENCY",DATETIME:"DATETIME",FORMULA:"FORMULA",LOGICAL:"LOGICAL",NUMBER:"NUMBER",TEXT:"TEXT"},r={CELL_NOT_FOUND:"CELL_NOT_FOUND",COLUMN_NOT_FOUND:"COLUMN_NOT_FOUND",ROW_NOT_FOUND:"ROW_NOT_FOUND",ERROR_READING_FILE:"ERROR_READING_FILE",ERROR_WRITING_FILE:"ERROR_WRITING_FILE",FILE_NOT_FOUND:"FILE_NOT_FOUND",FILETYPE_NOT_SUPPORTED:"FILETYPE_NOT_SUPPORTED",INVALID_DOCUMENT_FORMAT:"INVALID_DOCUMENT_FORMAT",INVALID_DOCUMENT_NAMESPACE:"INVALID_DOCUMENT_NAMESPACE",MALFORMED_JSON:"MALFORMED_JSON",UNIMPLEMENTED_METHOD:"UNIMPLEMENTED_METHOD",UNKNOWN_ERROR:"UNKNOWN_ERROR",UNSUPPORTED_BROWSER:"UNSUPPORTED_BROWSER"},n={CSV:"csv",HTML:"html",JSON:"json",TSV:"tsv",XLS:"xls",XLSX:"xlsx",XML:"xml"},i={CSV:"text/csv",HTML:"text/html",JSON:"application/json",TSV:"text/tab-separated-values",XLS:"application/vnd.ms-excel",XLSX:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",XML:"text/xml",XML2003:"application/xml"},p={FILENAME:/.*\./g,LINEBREAK:/\r\n?|\n/g,COMMA:/(,)(?=(?:[^"]|"[^"]*")*$)/g,QUOTATION:/(^")(.*)("$)/g,TWO_QUOTES:/""/g},s={getFiletype:function(t){return t.replace(p.FILENAME,"")},isEqual:function(t,e,r){return r?t.toLowerCase()==e.toLowerCase():t==e},isSupportedBrowser:function(){return!![].forEach&&!!t.FileReader},overrideProperties:function(t,e){for(var r in t)t.hasOwnProperty(r)&&(t[r]=e.hasOwnProperty(r)?e[r]:t[r]);return t}},a=function(t,e){var r={value:t||"",dataType:e||o.TEXT};typeof t==typeof{}&&(r=s.overrideProperties(r,t)),this.value=r.value,this.dataType=r.dataType,this.toString=function(){return t.toString()}},c=function(){};c.prototype=[],c.prototype.getCell=function(t,e){return this[e-1][t-1]},c.prototype.getColumn=function(e){var r=[];return this.forEach(function(t){r.push(t[e-1])}),r},c.prototype.getRow=function(t){return this[t-1]};var E=function(){this.records=new c};E.prototype.getCell=function(t,e){return this.records.getCell(t,e)},E.prototype.getColumn=function(t){return this.records.getColumn(t)},E.prototype.getRow=function(t){return this.records.getRow(t)},E.prototype.insertRecord=function(t){return this.records.push(t),this},E.prototype.removeRecord=function(t){return this.records.splice(t-1,1),this},E.prototype.setRecords=function(t){return this.records=t,this};var u=function(){};u.prototype={_filetype:"",_sheet:[],getSheet:function(t){return t=t||1,this._sheet[t-1].records},loadFile:function(t,e){var r=this,o=new FileReader;return o.onload=function(){r.loadString(this.result,0),e.apply(r)},o.readAsText(t),r},loadString:function(){throw r.UNIMPLEMENTED_METHOD}};var l=function(){};l.prototype=new u,l.prototype._delimiter=e.COMMA,l.prototype._filetype=n.CSV,l.prototype.loadString=function(t,o){var n=this;return o=o||0,n._sheet[o]=new E,t.replace(p.LINEBREAK,e.NEWLINE).split(e.NEWLINE).forEach(function(t){var e=t.split(p.COMMA),r=[];e.forEach(function(t){t!==n._delimiter&&(t=(t=t.replace(p.QUOTATION,"$2")).replace(p.TWO_QUOTES,'"'),r.push(new a(t)))}),n._sheet[o].insertRecord(r)}),n},l.prototype.setDelimiter=function(t){return this._delimiter=t,this};var h=function(){};h.prototype=new u,h.prototype._filetype=n.HTML,h.prototype.loadString=function(t,o){var n=this,e=(new DOMParser).parseFromString(t,i.HTML).getElementsByTagName("table");return o=o||0,[].forEach.call(e,function(t){n._sheet[o]=new E;var e=t.getElementsByTagName("tr");[].forEach.call(e,function(t){var e=t.getElementsByTagName("td"),r=[];[].forEach.call(e,function(t){r.push(new a(t.innerHTML))}),n._sheet[o].insertRecord(r)}),o++}),n};var _=function(){};_.prototype=new l,_.prototype._delimiter=e.TAB,_.prototype._filetype=n.TSV;var f=function(){};f.prototype=new u,f.prototype._filetype=n.XML,f.prototype.loadString=function(t,o){var n=this,e=(new DOMParser).parseFromString(t,i.XML).getElementsByTagName("Worksheet");return o=o||0,[].forEach.call(e,function(t){n._sheet[o]=new E;var e=t.getElementsByTagName("Row");[].forEach.call(e,function(t){var e=t.getElementsByTagName("Data"),r=[];[].forEach.call(e,function(t){r.push(new a(t.innerHTML))}),n._sheet[o].insertRecord(r)}),o++}),n};var T={CSV:l,HTML:h,TSV:_,XML:f},N=function(){};N.prototype={_filetype:"",_mimetype:"",_sheet:[],getSheet:function(t){return t=t||1,this._sheet[t-1].records},getString:function(){throw r.UNIMPLEMENTED_METHOD},insertSheet:function(t){if(t.records)this._sheet.push(t);else{var e=new E;e.setRecords(t),this._sheet.push(e)}return this},removeSheet:function(t){return this._sheet.splice(t-1,1),this},saveFile:function(){return t.open("data:"+this._mimetype+";base64,"+t.btoa(this.getString())),this}};var O=function(){};O.prototype=new N,O.prototype._delimiter=e.COMMA,O.prototype._filetype=n.CSV,O.prototype._mimetype=i.CSV,O.prototype.getString=function(){var e=this,r="";return this.getSheet(1).forEach(function(t){t.forEach(function(t){r+=t+e._delimiter}),r+="\r\n"}),r},O.prototype.setDelimiter=function(t){return this._delimiter=t,this};var y=function(){};y.prototype=new O,y.prototype._delimiter=e.TAB,y.prototype._filetype=n.TSV,y.prototype._mimetype=i.TSV;var R={CSV:O,TSV:y},M={Cell:a,DataType:o,Exception:r,isSupportedBrowser:s.isSupportedBrowser(),Parser:T,Sheet:E,Writer:R};t.SimpleExcel=M}(this);